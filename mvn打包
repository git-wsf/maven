---maven打包

  mvn clean && mvn -Dmaven.test.skip=true install -Ptest(指定profile)


  mvn clean && mvn -Dmaven.test.skip=true install -Ponline(指定profile)
  
<build>
		<finalName>browsercloud</finalName>
		<plugins>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-jar-plugin</artifactId>
				<executions>
					<execution>
						<id>make-a-jar</id>
						<phase>compile</phase>
						<goals>
							<goal>jar</goal>
						</goals>
					</execution>
				</executions>
			</plugin>
			<plugin>
				<artifactId>maven-assembly-plugin</artifactId>
				<version>2.6</version>
				<configuration>
					<!-- not append assembly id in release file name -->
					<appendAssemblyId>false</appendAssemblyId>
					<descriptors>
						<descriptor>assembly.xml</descriptor>
					</descriptors>
				</configuration>
				<executions>
					<execution>
						<id>make-assembly</id>
						<phase>package</phase>
						<goals>
							<goal>single</goal>
						</goals>
					</execution>
				</executions>
			</plugin>
		</plugins>
	</build>
  
  
  
  
====指定文件
  <profiles>
		<profile>
			<id>test</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
			<properties>
				<env>test</env>
			</properties>
		</profile>
		<profile>
			<id>online-mumbai</id>
			<properties>
				<env>online-mumbai</env>
			</properties>
		</profile>
	</profiles>
	
	
	

解疑惑----maven中snapshot相关jar无法拉取问题
2018年05月17日 10:36:25
阅读数：283
这段时间maven中经常不能拉取snapshot相关jar的问题一直困扰着，今天把相关解决方案整理下。 
使用的是局域网中的Snaptype Nexus服务器的，maven的setting-main.xml相关配置如下：

<!-- <mirrors> ... </mirrors> -->

</profile>  
     <profile>
      <id>redstar-nexus</id>
      <repositories>
        <repository>
          <id>central</id>
          <url>http://nexus.******.com/nexus/content/groups/public/</url>
          <releases><enabled>true</enabled></releases>
          <snapshots><enabled>true</enabled></snapshots>
          <updatePolicy>always</updatePolicy>

        </repository>
      </repositories>
      <pluginRepositories>
        <pluginRepository>
          <id>central</id>
          <url>http://nexus.******.com/nexus/content/groups/public/</url>
          <releases><enabled>true</enabled></releases>
          <snapshots><enabled>true</enabled></snapshots>
          <updatePolicy>always</updatePolicy>
        </pluginRepository>
      </pluginRepositories>
</profile>

<activeProfiles>
    <activeProfile>redstar-nexus</activeProfile>
</activeProfiles>
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
项目中有相关pom.xml引入的jar配置：

<!-- 引入父jar包 -->
<parent>
    <artifactId>parent</artifactId>
    <groupId>com.*****</groupId>
    <version>1.3.0.RELEASE</version>
</parent>

<!-- 引入服务的snapshot包-->
<dependencies>
  <dependency>
    <groupId>com.*******</groupId>
    <artifactId>show-tools</artifactId>
    <version>1.0.2-SNAPSHOT</version>
  </dependency>
</dependencies>
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
在使用项目的clean命令时，报错。因为默认是从maven的中央仓库中，更新jar报，但是报找不到parent中的引入jar包的。为了解决问题。在setting-main.xml文件中添加 <mirror>的相关配置：

<mirror>
            <id>private-mirror</id>
            <mirrorOf>*</mirrorOf>
            <name>private-mirror</name>
            <url>http://nexus.*****.com/nexus/content/groups/public/</url>
        </mirror>
1
2
3
4
5
6
这样只解决了仓库引入的问题。snapshot的jar引入依然没有解决。 
但是mirror的配置，只对release有效，对于snapshot无效的。所以我们添加个对snapshot有效的：

<mirrors>
    <mirror>
        <id>private-mirror</id>
        <mirrorOf>*</mirrorOf>
        <name>private-mirror</name>
        <url>http://nexus.corp.rs.com/nexus/content/groups/public/</url>
    </mirror>

    <mirror>
        <id>private-snapshots</id>
        <url>http://nexus.****.com/nexus/content/repositories/snapshots/</url>
        <mirrorOf>public-snapshots</mirrorOf>
    </mirror>
</mirrors>

<profile>
    <id>public-snapshots</id>
    <repositories>  
        <repository>
            <id>nexus_snapshot_repository</id>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
            <url>http://nexus.*****.com/nexus/content/repositories/snapshots/</url>
            <layout>default</layout>
        </repository>

    </repositories>

    <pluginRepositories>
        <pluginRepository>
          <id>central</id>
          <url>http://nexus.*****.com/nexus/content/groups/public/</url>
          <releases><enabled>true</enabled></releases>
          <snapshots><enabled>true</enabled></snapshots>
          <updatePolicy>always</updatePolicy>
        </pluginRepository>
    </pluginRepositories>

</profile>

<activeProfiles>
    <activeProfile>public-snapshots</activeProfile>
</activeProfiles>

问题解决。这个配置的有些繁琐的，应该有更方便的方式。后续更新优化的。

snapshot的出现是解决release版本有变动要升级，在开发过程中造成频繁升级的问题的。maven会自动从仓库中检查引入服务的snapshot版本的最新版本，发现有要更新的时候进行下载的。默认每天一更新。通过updatePolicy控制（默认值是daily，表示Maven每天检查一次。其他可用的值包括：never-从不检查更新；always-每次构建都检查更新；interval：X-每隔X分钟检查一次更新（X为任意整数））
	
	
	
	
	
	
	
	
	
	
	
